# 結合テスト項目書 (Integration Test Cases)

## テスト項目一覧

### 1. 機能結合テスト (Functional Integration)

| Test ID | 項目名 | 前提条件 | テスト手順 | 期待値 | 優先度 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC-F-01** | 基本フロー実行 | ・`config.yml`に有効なAPIキーが設定されていること<br>・一般的なキーワード（例: "LLM agent"）が設定されていること | 1. `app.py`を起動し、ブラウザでアクセスする<br>2. 「実行」タブから「パイプライン実行開始」をクリックする | ・画面上のログエリアに「Process complete!」が表示されること<br>・`data/`配下に結果フォルダが生成され、`final_review_matrix.csv`が作成されること | 高 |
| **TC-F-02** | Snowball反復実行確認 | ・反復回数（Iterations）を `2` に設定<br>・Snowball件数を `3` に設定 | 1. パイプラインを実行する<br>2. ログを確認し、Iteration 2 が開始されているか確認する | ・ログに「--- Iteration 1 ---」「--- Iteration 2 ---」が出力されること<br>・Iteration 2 の検索シード数が、Iteration 1 のトップ論文数と一致していること | 中 |
| **TC-F-03** | フィルタリング条件の反映 | ・発行年を「2024-2025」に設定<br>・最小引用数を「1000」などの高い値に設定 | 1. パイプラインを実行する<br>2. 生成された `collected_papers_iter_1.csv` を確認する | ・CSV内の論文の発行年がすべて2024以降であること<br>・引用数が1000未満の論文が含まれていないこと（または該当なしで0件になること） | 中 |

### 2. データ整合性テスト (Data Consistency)

| Test ID | 項目名 | 前提条件 | テスト手順 | 期待値 | 優先度 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC-D-01** | 最終成果物のカラム確認 | ・TC-F-01実施後 | 1. `final_review_matrix.csv` を開き、カラム構成を確認する | ・必須カラム（`doi`, `title`, `abstract`, `relevance_score`, `summary`）が存在すること<br>・`summary` や `relevance_reason` が日本語で記述されていること | 高 |
| **TC-D-02** | 重複除外の確認 | ・同一キーワードで複数回検索されるような設定にする | 1. パイプライン実行後、`final_review_matrix.csv` を確認する | ・同一DOIの行が重複して存在していないこと | 低 |

### 3. 異常系テスト (Error Handling)

| Test ID | 項目名 | 前提条件 | テスト手順 | 期待値 | 優先度 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC-E-01** | 無効なAPIキー | ・`.env` または環境変数の `GOOGLE_API_KEY` を無効な文字列に変更する | 1. パイプラインを実行する | ・アプリがクラッシュせず、エラーログが出力され終了すること<br>・UI上に「エラーが発生しました」等の適切なメッセージが表示されること | 中 |
| **TC-E-02** | 検索結果ゼロ件 | ・キーワードに存在しない文字列（例: "xhdkjhfkjsdhf"）を設定する | 1. パイプラインを実行する | ・「No papers found from keyword search」等のログが出力されること<br>・空のCSV等の生成、または適切なメッセージでの終了処理が行われること | 低 |
| **TC-E-03** | UIからの無効なDOI入力 | ・UI設定画面を開く | 1. シード論文DOIに不正な形式（例: "invalid_doi"）を入力する | ・UI上に警告メッセージ（Warning）が表示されること<br>・（実行した場合）当該DOIがスキップされ、処理が継続すること | 低 |

### 4. UI動作テスト (UI Behavior)

| Test ID | 項目名 | 前提条件 | テスト手順 | 期待値 | 優先度 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC-U-01** | 設定保存の永続化 | ・UI設定画面を開く | 1. プロジェクト名やキーワードを変更し、「設定を保存」をクリック<br>2. ブラウザをリロードする | ・変更した設定値がフォームに保持されていること（`config.yml`から再読み込みされていること） | 中 |
| **TC-U-02** | 結果CSVのダウンロード | ・TC-F-01実施後 | 1. 「実行」更新タブの結果ビューワセクションで、最新の実行を選択<br>2. 「結果のプレビュー」が表示されることを確認<br>3. ダウンロードボタンを押下 | ・CSVファイルが正常にダウンロードできること | 中 |
